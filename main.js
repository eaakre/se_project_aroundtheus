!function(){"use strict";class e{constructor(e,t,s,i,r){let{name:n,link:o,_id:a,isLiked:l}=e;this._name=n,this._link=o,this._id=a,this._isLiked=l,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClick=r}_getCardElement(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".cards__list-item").cloneNode(!0)}_setEventsListeners(){this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,url:this._link})})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}handleDeleteCard=()=>{this._cardElement.remove(),this._cardElement=null};setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}_renderLikes(){this._isLiked?this._likeButton.classList.add("cards__favorite_active"):this._likeButton.classList.remove("cards__favorite_active")}getView(){return this._cardElement=this._getCardElement(),this._cardTitle=this._cardElement.querySelector(".cards__title"),this._cardImage=this._cardElement.querySelector(".cards__image"),this._likeButton=this._cardElement.querySelector(".cards__favorite"),this._deleteButton=this._cardElement.querySelector(".cards__delete-button"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._setEventsListeners(),this._renderLikes(),this._cardElement}}class t{constructor(e,t){let{data:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.reverse().forEach(this._renderer)}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class i extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=this._popupElement.querySelectorAll(".form__input"),this._handleFormSubmit=t,this._popupSubmit=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=e?t:"Save"}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){super.close(),this._popupForm.reset()}}class r{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e,t){const s=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){if(this._hasInvalidInput(this._inputList))return this.disableButton();this._enableButton()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_checkValidity(e){if(!e.validity.valid)return this._showInputError(e,e.validationMessage);this._hideInputError(e)}_setEventListeners(){this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const n={formSelector:".modal__form",inputSelector:".form__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},o=document.querySelector("#profile-edit-modal"),a=document.forms["edit-form"],l=document.forms["add-form"],c=document.forms["update-avatar-form"],d=document.querySelector(".profile__edit-button"),u=document.querySelector(".profile__add-button"),h=(document.querySelectorAll(".cards__delete-button"),document.querySelector(".profile__avatar-edit")),_=o.querySelector(".form__input_name"),m=o.querySelector(".form__input_description");let p,v;function b(e){const t=E(e);p.addItem(t)}function f(e,t){B.open(e,t)}function S(e){e.isLiked()?k.removeLikeCard(e._id).then((t=>{e.setIsLiked(t.isLiked)})).catch((e=>{console.error(e)})):k.likeCard(e._id).then((t=>{e.setIsLiked(t.isLiked)})).catch((e=>{console.error(e)}))}const E=t=>new e(t,"#cards__list-item",f,x,S).getView(),L=new class{constructor(e){let{userName:t,userAbout:s,userAvatar:i}=e;this._userName=document.querySelector(t),this._userAbout=document.querySelector(s),this._userAvatar=document.querySelector(i)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent}}setUserInfo(e){this._userName.textContent=e.name,this._userAbout.textContent=e.about}setUserAvatar(e,t){this._userAvatar.src=e,this._userAvatar.alt=t+" avatar"}}({userName:".profile__title",userAbout:".profile__description",userAvatar:".profile__avatar"}),k=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._authorization=s.authorization,this._contentType=s["Content-Type"],this._headers=s}_checkResponse(e){if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}updateProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",body:JSON.stringify({name:e.name,about:e.about}),headers:this._headers}).then(this._checkResponse)}addCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",body:JSON.stringify({name:e,link:t}),headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeLikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a93ebd2f-fd06-499f-b2f9-74e2f8519709","Content-Type":"application/json"}});Promise.all([k.getUser(),k.getInitialCards()]).then((e=>{let[s,i]=e;L.setUserInfo({name:s.name,about:s.about}),L.setUserAvatar(s.avatar,s.name),p=new t({data:i,renderer:b},".cards__list"),p.renderItems()})).catch((e=>console.log(e))),new r(n,a).enableValidation();const C=new r(n,l);C.enableValidation();const y=new r(n,c);y.enableValidation();const g=new i("#profile-edit-modal",(e=>{g.setSubmitText(!0),k.updateProfile(e).then((e=>{L.setUserInfo(e),g.close()})).catch((e=>console.log(e))).finally((()=>g.setSubmitText(!1)))}));g.setEventListeners(),d.addEventListener("click",(()=>{g.open();const e=L.getUserInfo();_.value=e.name,m.value=e.about}));const I=new i("#profile-add-modal",(e=>{let{title:t,image:s}=e;I.setSubmitText(!0),k.addCard(t,s).then((e=>{v=E({name:e.name,link:e.link,_id:e._id,isLiked:!1}),p.addItem(v),I.close()})).catch((e=>console.log(e))).finally((()=>I.setSubmitText(!1)))}));I.setEventListeners(),u.addEventListener("click",(()=>{C.disableButton(),I.open()}));const q=new i("#update-avatar-modal",(e=>{q.setSubmitText(!0),k.updateProfilePicture(e.image).then((e=>{L.setUserAvatar(e.avatar,e.name),q.close()})).catch((e=>console.log(e))).finally((()=>q.setSubmitText(!1)))}));q.setEventListeners(),h.addEventListener("click",(()=>{y.disableButton(),q.open()}));const B=new class extends s{constructor(e){super({popupSelector:e}),this._cardImage=document.querySelector(".modal__image"),this._cardTitle=document.querySelector(".modal__title")}open(e){this._cardImage.src=e.url,this._cardTitle.textContent=e.title,this._cardImage.alt=e.title,super.open()}}("#card-modal");B.setEventListeners();const T=new class extends s{constructor(e){super({popupSelector:e}),this._popupConfirm=this._popupElement.querySelector(".modal__form"),this._popupSubmit=this._popupElement.querySelector(".modal__button")}setEventListeners(){this._popupConfirm.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=e?t:"Yes"}setSubmitAction(e){this._handleSubmit=e}}("#delete-card-modal");function x(e){T.open(),T.setSubmitAction((()=>{T.setSubmitText(!0,"Deleting..."),k.deleteCard(e._id).then((()=>{T.close(),e.handleDeleteCard()})).catch((e=>console.error(e))).finally((()=>T.setSubmitText(!1)))}))}T.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dkIsR0pnSzJDLHNCQUc3QyxTQUFTeE0sRUFBa0J3SSxHQUN6QjRELEVBQWdCNUksT0FDaEI0SSxFQUFnQkcsaUJBQWdCLEtBQzlCSCxFQUFnQnhILGVBQWMsRUFBTSxlQUNwQzZELEVBQ0c2QyxXQUFXOUMsRUFBS3BJLEtBQ2hCdUksTUFBSyxLQUNKeUQsRUFBZ0IxSSxRQUNoQjhFLEVBQUs5RyxrQkFBa0IsSUFFeEJtSCxPQUFPQyxHQUFRQyxRQUFRQyxNQUFNRixLQUM3QmlELFNBQVEsSUFBTUssRUFBZ0J4SCxlQUFjLElBQU8sR0FFMUQsQ0FmQXdILEVBQWdCdEksbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9pZCA9IF9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICBfZ2V0Q2FyZEVsZW1lbnQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0LWl0ZW1cIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG4gIF9zZXRFdmVudHNMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgdXJsOiB0aGlzLl9saW5rIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG4gIH1cblxuICBoYW5kbGVEZWxldGVDYXJkID0gKCkgPT4ge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfTtcblxuICBzZXRJc0xpa2VkKGxpa2VkU3RhdHVzKSB7XG4gICAgdGhpcy5faXNMaWtlZCA9IGxpa2VkU3RhdHVzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRDYXJkRWxlbWVudCgpO1xuXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZmF2b3JpdGVcIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50c0xpc3RlbmVycygpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuICAgIHRoaXMuX2l0ZW1zLnJldmVyc2UoKS5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpIHx8XG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBTdWJtaXQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGRhdGEgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGRhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIHNldFN1Ym1pdFRleHQoc3VibWl0LCBzdWJtaXRUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChzdWJtaXQpIHtcbiAgICAgIHRoaXMuX3BvcHVwU3VibWl0LnRleHRDb250ZW50ID0gc3VibWl0VGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtKSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICByZXR1cm4gdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfVxuICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICB9XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcbiAgICApO1xuICB9XG5cbiAgX2NoZWNrVmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfVxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJEaXNuZXkgV29ybGRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTk3NDY2NTk5MzYwLTNiOTc3NTg0MWFlYz9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03NjQmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHb29zZWJlcnJ5IEZhbGxzXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTYxODUwMjEwNTYzNC1kZGIyOGM3NDhkZGI/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njg3JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiV2lsbGlzIFRvd2VyXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU1NjQ3MjkwOC0wZjc3ZTgxNWQ4MWI/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzY0JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR2F0ZXdheSBBcmNoXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU5MzU2OTI0ODgwNS0xODI1NDJmODJjMTQ/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzE1JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiRXN0ZXMgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MjAwNTA3MzUwODctMWVkNjVkOWIwMjczP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTczNSZxPTgwXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkdsYWNpZXIgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE0NzE4OTMzNzAwNTAtMmMxYTM2Y2Y1NTVjP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTExNzgmcT04MFwiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG4vLyBXcmFwcGVyc1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcblxuLy8gRm9ybXNcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtZm9ybVwiXTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWZvcm1cIl07XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1widXBkYXRlLWF2YXRhci1mb3JtXCJdO1xuXG4vLyBGaW5kIG9wZW4gYnV0dG9ucyBmb3IgbW9kYWxzXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICBcIi5jYXJkc19fZGVsZXRlLWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBdmF0YXJFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWVkaXRcIlxuKTtcblxuLy8gRWRpdCBQcm9maWxlIElucHV0c1xuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF9uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IGlucHV0RGVzY3JpcHRpb24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLmZvcm1fX2lucHV0X2Rlc2NyaXB0aW9uXCJcbik7XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7XG4gIGNvbmZpZyxcbiAgcHJvZmlsZUVkaXRGb3JtLFxuICBhZGRDYXJkRm9ybSxcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIGlucHV0TmFtZSxcbiAgaW5wdXREZXNjcmlwdGlvbixcbiAgcHJvZmlsZUFkZEJ1dHRvbixcbiAgcHJvZmlsZUF2YXRhckVkaXQsXG4gIGF2YXRhckZvcm0sXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmxldCBjYXJkTGlzdDtcbmxldCBuZXdDYXJkO1xuXG4vLyBGdW5jdGlvbnNcbmZ1bmN0aW9uIHJlbmRlckNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhuYW1lLCBsaW5rKSB7XG4gIGNhcmRQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xufVxuXG4vLyBMaWtlIENhcmQgRnVuY3Rpb25hbGl0eVxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcbiAgaWYgKCFjYXJkLmlzTGlrZWQoKSkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuX2lkKVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBjYXJkLnNldElzTGlrZWQocmVzLmlzTGlrZWQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGFwaVxuICAgICAgLnJlbW92ZUxpa2VDYXJkKGNhcmQuX2lkKVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBjYXJkLnNldElzTGlrZWQocmVzLmlzTGlrZWQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbmNvbnN0IGNyZWF0ZUNhcmQgPSAoY2FyZE9iamVjdCkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgY2FyZE9iamVjdCxcbiAgICBcIiNjYXJkc19fbGlzdC1pdGVtXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufTtcblxuLy8gZW5hYmxlIHVzZXJJbmZvXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHVzZXJOYW1lOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICB1c2VyQWJvdXQ6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIHVzZXJBdmF0YXI6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxufSk7XG5cbi8vIGVuYWJsZSBBUEkgY2FsbHNcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImE5M2ViZDJmLWZkMDYtNDk5Zi1iMmY5LTc0ZTJmODUxOTcwOVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vIFJlbmRlciB1c2VyIGluZm8gYW5kIGNhcmRzIG9uIHBhZ2UgbG9hZFxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VyKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbZGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiBkYXRhLm5hbWUsIGFib3V0OiBkYXRhLmFib3V0IH0pO1xuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoZGF0YS5hdmF0YXIsIGRhdGEubmFtZSk7XG4gICAgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAgICAgIHsgZGF0YTogY2FyZHMsIHJlbmRlcmVyOiByZW5kZXJDYXJkIH0sXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXG4gICAgKTtcbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG5cbi8vIGVuYWJsaW5nIHZhbGlkYXRpb24gYnkgY2FsbGluZyBlbmFibGVWYWxpZGF0aW9uKClcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9maWxlRWRpdEZvcm0pO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhZGRDYXJkRm9ybSk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYXZhdGFyRm9ybSk7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gRWRpdGluZyBQcm9maWxlIEludGVyYWN0aW9uXG4vLyBFZGl0IFByb2ZpbGUgSW5mb3JtYXRpb25cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwcm9maWxlLWVkaXQtbW9kYWxcIiwgKGRhdGEpID0+IHtcbiAgZWRpdFByb2ZpbGVQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZShkYXRhKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IGVkaXRQcm9maWxlUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xufSk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIE9uIGNsaWNrIGV2ZW50IGZvciBlZGl0UHJvZmlsZSBidXR0b25cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIGlucHV0RGVzY3JpcHRpb24udmFsdWUgPSB1c2VyRGF0YS5hYm91dDtcbn0pO1xuXG4vLyBOZXcgQ2FyZCBJbnRlcmFjdGlvblxuLy8gQWRkIG5ldyBjYXJkXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcbiAgKHsgdGl0bGUsIGltYWdlIH0pID0+IHtcbiAgICBuZXdDYXJkUG9wdXAuc2V0U3VibWl0VGV4dCh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKHRpdGxlLCBpbWFnZSlcbiAgICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgIG5ld0NhcmQgPSBjcmVhdGVDYXJkKHtcbiAgICAgICAgICBuYW1lOiBjYXJkLm5hbWUsXG4gICAgICAgICAgbGluazogY2FyZC5saW5rLFxuICAgICAgICAgIF9pZDogY2FyZC5faWQsXG4gICAgICAgICAgaXNMaWtlZDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKG5ld0NhcmQpO1xuICAgICAgICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IG5ld0NhcmRQb3B1cC5zZXRTdWJtaXRUZXh0KGZhbHNlKSk7XG4gIH1cbik7XG5uZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gT24gY2xpY2sgZXZlbnQgZm9yIGFkZENhcmQgYnV0dG9uXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICBuZXdDYXJkUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIFByb2ZpbGUgUGljdHVyZSBJbnRlcmFjdGlvblxuLy8gVXBkYXRlIFByb2ZpbGUgUGljdHVyZVxuY29uc3QgdXBkYXRlQXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiN1cGRhdGUtYXZhdGFyLW1vZGFsXCIsIChpbWFnZSkgPT4ge1xuICB1cGRhdGVBdmF0YXJQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZVBpY3R1cmUoaW1hZ2UuaW1hZ2UpXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhciwgdXNlckRhdGEubmFtZSk7XG4gICAgICB1cGRhdGVBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4gdXBkYXRlQXZhdGFyUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xufSk7XG51cGRhdGVBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBPbiBjbGljayBldmVudCBmb3IgdXBkYXRlIHByb2ZpbGUgcGljdHVyZVxucHJvZmlsZUF2YXRhckVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIHVwZGF0ZUF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBFeGlzdGluZyBDYXJkIEludGVyYWN0aW9uXG4vLyBab29tIGluIG9uIGNhcmQgaW1hZ2VcbmNvbnN0IGNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNjYXJkLW1vZGFsXCIpO1xuY2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIERlbGV0ZSBDYXJkIFBvcHVwXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybShcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUsIFwiRGVsZXRpbmcuLi5cIik7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXG4gICAgICAuZmluYWxseSgoKSA9PiBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xuICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZSwgdXNlckFib3V0LCB1c2VyQXZhdGFyIH0pIHtcbiAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWUpO1xuICAgIHRoaXMuX3VzZXJBYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckFib3V0KTtcbiAgICB0aGlzLl91c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcbiAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihpbWFnZSwgbmFtZSkge1xuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gaW1hZ2U7XG4gICAgdGhpcy5fdXNlckF2YXRhci5hbHQgPSBuYW1lICsgXCIgYXZhdGFyXCI7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgLy8gY29uc3RydWN0b3IgYm9keVxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2F1dGhvcml6YXRpb24gPSBoZWFkZXJzLmF1dGhvcml6YXRpb247XG4gICAgdGhpcy5fY29udGVudFR5cGUgPSBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfSBlbHNlIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXG4gIGdldFVzZXIoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZShkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICB9KSxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZENhcmQodGl0bGUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiB0aXRsZSxcbiAgICAgICAgbGluazogbGluayxcbiAgICAgIH0pLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlUGljdHVyZShsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3RpdGxlXCIpO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IGRhdGEudXJsO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEudGl0bGU7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IGRhdGEudGl0bGU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cENvbmZpcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9wb3B1cFN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cENvbmZpcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHNldFN1Ym1pdFRleHQoc3VibWl0LCBzdWJtaXRUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChzdWJtaXQpIHtcbiAgICAgIHRoaXMuX3BvcHVwU3VibWl0LnRleHRDb250ZW50ID0gc3VibWl0VGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBcIlllc1wiO1xuICAgIH1cbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBhY3Rpb247XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibmFtZSIsImxpbmsiLCJfaWQiLCJpc0xpa2VkIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0Q2FyZEVsZW1lbnQiLCJfY2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50c0xpc3RlbmVycyIsIl9jYXJkSW1hZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwidXJsIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInJlbW92ZSIsInNldElzTGlrZWQiLCJsaWtlZFN0YXR1cyIsIl9yZW5kZXJMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsImdldFZpZXciLCJfY2FyZFRpdGxlIiwic3JjIiwidGV4dENvbnRlbnQiLCJhbHQiLCJTZWN0aW9uIiwic2VsZWN0b3IiLCJkYXRhIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2xlYXIiLCJpbm5lckhUTUwiLCJyZW5kZXJJdGVtcyIsInJldmVyc2UiLCJmb3JFYWNoIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cFN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRTdWJtaXRUZXh0Iiwic3VibWl0Iiwic3VibWl0VGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja1ZhbGlkaXR5IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVFZGl0Rm9ybSIsImZvcm1zIiwiYWRkQ2FyZEZvcm0iLCJhdmF0YXJGb3JtIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUF2YXRhckVkaXQiLCJpbnB1dE5hbWUiLCJpbnB1dERlc2NyaXB0aW9uIiwiY2FyZExpc3QiLCJuZXdDYXJkIiwicmVuZGVyQ2FyZCIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsImNhcmRQb3B1cCIsImNhcmQiLCJhcGkiLCJyZW1vdmVMaWtlQ2FyZCIsInRoZW4iLCJyZXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImxpa2VDYXJkIiwiY2FyZE9iamVjdCIsInVzZXJJbmZvIiwidXNlck5hbWUiLCJ1c2VyQWJvdXQiLCJ1c2VyQXZhdGFyIiwiX3VzZXJOYW1lIiwiX3VzZXJBYm91dCIsIl91c2VyQXZhdGFyIiwiZ2V0VXNlckluZm8iLCJhYm91dCIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImltYWdlIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9hdXRob3JpemF0aW9uIiwiYXV0aG9yaXphdGlvbiIsIl9jb250ZW50VHlwZSIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJnZXRVc2VyIiwidXBkYXRlUHJvZmlsZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsInRpdGxlIiwiZGVsZXRlQ2FyZCIsInVwZGF0ZVByb2ZpbGVQaWN0dXJlIiwiYXZhdGFyIiwiYWxsIiwiY2FyZHMiLCJsb2ciLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImVkaXRQcm9maWxlUG9wdXAiLCJmaW5hbGx5IiwidXNlckRhdGEiLCJuZXdDYXJkUG9wdXAiLCJfcmVmMiIsInVwZGF0ZUF2YXRhclBvcHVwIiwiZGVsZXRlQ2FyZFBvcHVwIiwiX3BvcHVwQ29uZmlybSIsIl9oYW5kbGVTdWJtaXQiLCJzZXRTdWJtaXRBY3Rpb24iLCJhY3Rpb24iXSwic291cmNlUm9vdCI6IiJ9