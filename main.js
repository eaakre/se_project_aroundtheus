!function(){"use strict";class e{constructor(e,t,s,i,r){let{name:n,link:o,_id:a,isLiked:l}=e;this._name=n,this._link=o,this._id=a,this._isLiked=l,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClick=r}_getCardElement(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".cards__list-item").cloneNode(!0)}_setEventsListeners(){this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,url:this._link})})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}handleDeleteCard=()=>{this._cardElement.remove(),this._cardElement=null};handleLikeIcon=()=>{this._likeButton.classList.toggle("cards__favorite_active")};getView(){return this._cardElement=this._getCardElement(),this._cardTitle=this._cardElement.querySelector(".cards__title"),this._cardImage=this._cardElement.querySelector(".cards__image"),this._likeButton=this._cardElement.querySelector(".cards__favorite"),this._deleteButton=this._cardElement.querySelector(".cards__delete-button"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._setEventsListeners(),this._isLiked&&this._likeButton.classList.add("cards__favorite_active"),this._cardElement}}class t{constructor(e,t){let{data:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.reverse().forEach(this._renderer)}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class i extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=this._popupElement.querySelectorAll(".form__input"),this._handleFormSubmit=t,this._popupSubmit=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=e?t:"Save"}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}close(){super.close(),this._popupForm.reset()}}class r{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e,t){const s=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){if(this._hasInvalidInput(this._inputList))return this.disableButton();this._enableButton()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_checkValidity(e){if(!e.validity.valid)return this._showInputError(e,e.validationMessage);this._hideInputError(e)}_setEventListeners(){this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const n={formSelector:".modal__form",inputSelector:".form__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},o=document.querySelector("#profile-edit-modal"),a=document.forms["edit-form"],l=document.forms["add-form"],c=document.querySelector(".profile__edit-button"),u=o.querySelector(".form__input_name"),h=o.querySelector(".form__input_description"),d=document.querySelector(".profile__add-button"),_=(document.querySelectorAll(".cards__delete-button"),document.querySelector(".profile__avatar"),document.querySelector(".profile__avatar-edit")),m=document.forms["update-avatar-form"];let p,v;function b(e){const t=E(e);p.addItem(t)}function f(e,t){I.open(e,t)}function S(e){e._isLiked?C.removeLikeCard(e._id).then((()=>{e.handleLikeIcon()})).catch((e=>{console.error(e)})):C.likeCard(e._id).then((()=>{e.handleLikeIcon()})).catch((e=>{console.error(e)}))}const E=t=>new e(t,"#cards__list-item",f,B,S).getView(),y=new class{constructor(e){let{userName:t,userAbout:s,userAvatar:i}=e;this._userName=document.querySelector(t),this._userAbout=document.querySelector(s),this._userAvatar=document.querySelector(i)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent}}setUserInfo(e){this._userName.textContent=e.name,this._userAbout.textContent=e.about}setUserAvatar(e,t){this._userAvatar.src=e,this._userAvatar.alt=t+" avatar"}}({userName:".profile__title",userAbout:".profile__description",userAvatar:".profile__avatar"}),C=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._authorization=s.authorization,this._contentType=s["Content-Type"]}_checkResponse(e){if(e.ok)return e.json()}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:"a93ebd2f-fd06-499f-b2f9-74e2f8519709"}}).then(this._checkResponse)}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}updateProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",body:JSON.stringify({name:e.name,about:e.about}),headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}addCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",body:JSON.stringify({name:e,link:t}),headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}removeLikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":this._contentType},body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a93ebd2f-fd06-499f-b2f9-74e2f8519709","Content-Type":"application/json"}});Promise.all([C.getUser(),C.getInitialCards()]).then((e=>{let[s,i]=e;y.setUserInfo({name:s.name,about:s.about}),y.setUserAvatar(s.avatar,s.name),p=new t({data:i,renderer:b},".cards__list",f,B,S),p.renderItems()})),new r(n,a).enableValidation();const L=new r(n,l);L.enableValidation(),new r(n,m).enableValidation();const k=new i("#profile-edit-modal",(e=>{k.setSubmitText(!0),console.log(e),C.updateProfile(e).then((e=>{y.setUserInfo(e),k.close()})).finally((()=>k.setSubmitText(!1)))}));k.setEventListeners(),c.addEventListener("click",(()=>{k.open();const e=y.getUserInfo();u.value=e.name,h.value=e.about;let t={name:u.value,about:h.value};y.setUserInfo(t)}));const g=new i("#profile-add-modal",(e=>{let{title:t,image:s}=e;g.setSubmitText(!0),C.addCard(t,s).then((e=>{v=E({name:e.name,link:e.link,_id:e._id,isLiked:!1}),p.addItem(v)})).catch((e=>console.log(e))).finally((()=>g.setSubmitText(!1)))}));g.setEventListeners(),d.addEventListener("click",(()=>{L.disableButton(),g.open()}));const T=new i("#update-avatar-modal",(e=>{T.setSubmitText(!0),C.updateProfilePicture(e.image).then((e=>{y.setUserAvatar(e.avatar),T.close()})).catch((e=>console.log(e))).finally((()=>T.setSubmitText(!1)))}));T.setEventListeners(),_.addEventListener("click",(()=>{L.disableButton(),T.open()}));const I=new class extends s{constructor(e){super({popupSelector:e}),this._cardImage=document.querySelector(".modal__image"),this._cardTitle=document.querySelector(".modal__title"),this._popupSubmit=this._popupElement.querySelector(".modal__button")}open(e){this._cardImage.src=e.url,this._cardTitle.textContent=e.title,this._cardImage.alt=e.title,super.open()}}("#card-modal");I.setEventListeners();const q=new class extends s{constructor(e){super({popupSelector:e}),this._popupConfirm=this._popupElement.querySelector(".modal__form"),this._popupSubmit=this._popupElement.querySelector(".modal__button")}setEventListeners(){this._popupConfirm.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=e?t:"Yes"}setSubmitAction(e){this._handleSubmit=e}}("#delete-card-modal");function B(e){q.open(),q.setSubmitAction((()=>{q.setSubmitText(!0,"Deleting..."),C.deleteCard(e._id).then((()=>{q.close(),e.handleDeleteCard()})).catch((e=>console.error(e))).finally((()=>q.setSubmitText(!1)))}))}q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFHLFlBRS9CeEUsS0FBS2lFLGFBQWFyQyxZQURoQjBDLEVBQzhCQyxFQUVBLEtBRXBDLENBRUFzSCxlQUFBQSxDQUFnQkMsR0FDZDlMLEtBQUs0TCxjQUFnQkUsQ0FDdkIsR0ptSzJDLHNCQUc3QyxTQUFTcE0sRUFBa0J1SSxHQUN6QnlELEVBQWdCekksT0FDaEJ5SSxFQUFnQkcsaUJBQWdCLEtBQzlCSCxFQUFnQnJILGVBQWMsRUFBTSxlQUNwQzZELEVBQ0d5QyxXQUFXMUMsRUFBS25JLEtBQ2hCc0ksTUFBSyxLQUNKc0QsRUFBZ0J2SSxRQUNoQjhFLEVBQUs3RyxrQkFBa0IsSUFFeEJpSCxPQUFPQyxHQUFRQyxRQUFRQyxNQUFNRixLQUM3QjhDLFNBQVEsSUFBTU0sRUFBZ0JySCxlQUFjLElBQU8sR0FFMUQsQ0FmQXFILEVBQWdCbkksbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9wb3B1cFdpdGhDb25maXJtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9pZCA9IF9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICBfZ2V0Q2FyZEVsZW1lbnQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0LWl0ZW1cIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG4gIF9zZXRFdmVudHNMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgdXJsOiB0aGlzLl9saW5rIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG4gIH1cblxuICBoYW5kbGVEZWxldGVDYXJkID0gKCkgPT4ge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfTtcblxuICBoYW5kbGVMaWtlSWNvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICB9O1xuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRDYXJkRWxlbWVudCgpO1xuXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZmF2b3JpdGVcIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50c0xpc3RlbmVycygpO1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuICAgIHRoaXMuX2l0ZW1zLnJldmVyc2UoKS5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpIHx8XG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBTdWJtaXQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGRhdGEgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGRhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIHNldFN1Ym1pdFRleHQoc3VibWl0LCBzdWJtaXRUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChzdWJtaXQpIHtcbiAgICAgIHRoaXMuX3BvcHVwU3VibWl0LnRleHRDb250ZW50ID0gc3VibWl0VGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtKSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICByZXR1cm4gdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfVxuICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICB9XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcbiAgICApO1xuICB9XG5cbiAgX2NoZWNrVmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfVxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJEaXNuZXkgV29ybGRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTk3NDY2NTk5MzYwLTNiOTc3NTg0MWFlYz9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03NjQmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHb29zZWJlcnJ5IEZhbGxzXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTYxODUwMjEwNTYzNC1kZGIyOGM3NDhkZGI/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njg3JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiV2lsbGlzIFRvd2VyXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU1NjQ3MjkwOC0wZjc3ZTgxNWQ4MWI/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzY0JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR2F0ZXdheSBBcmNoXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU5MzU2OTI0ODgwNS0xODI1NDJmODJjMTQ/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzE1JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiRXN0ZXMgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MjAwNTA3MzUwODctMWVkNjVkOWIwMjczP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTczNSZxPTgwXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkdsYWNpZXIgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE0NzE4OTMzNzAwNTAtMmMxYTM2Y2Y1NTVjP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTExNzgmcT04MFwiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG4vLyBXcmFwcGVyc1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcblxuLy8gRm9ybXNcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtZm9ybVwiXTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWZvcm1cIl07XG5cbi8vIEZpbmQgb3BlbiBhbmQgY2xvc2UgYnV0dG9ucyBmb3IgZWRpdCBwcm9maWxlIGJ1dHRvblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBpbnB1dE5hbWUgPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBpbnB1dERlc2NyaXB0aW9uID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5mb3JtX19pbnB1dF9kZXNjcmlwdGlvblwiXG4pO1xuXG4vLyBGaW5kIG9wZW4vY2xvc2UvZm9ybSBmaWVsZHMgZm9yIGFkZCBwcm9maWxlIGJ1dHRvblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gIFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCJcbik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhckVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19hdmF0YXItZWRpdFwiXG4pO1xuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInVwZGF0ZS1hdmF0YXItZm9ybVwiXTtcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvcG9wdXBXaXRoQ29uZmlybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IHtcbiAgY29uZmlnLFxuICBwcm9maWxlRWRpdEZvcm0sXG4gIGFkZENhcmRGb3JtLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgaW5wdXROYW1lLFxuICBpbnB1dERlc2NyaXB0aW9uLFxuICBwcm9maWxlQWRkQnV0dG9uLFxuICBwcm9maWxlQXZhdGFyLFxuICBwcm9maWxlQXZhdGFyRWRpdCxcbiAgYXZhdGFyRm9ybSxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxubGV0IGNhcmRMaXN0O1xubGV0IG5ld0NhcmQ7XG5cbi8vIEZ1bmN0aW9uc1xuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcbiAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcbiAgY2FyZFBvcHVwLm9wZW4obmFtZSwgbGluayk7XG59XG5cbi8vIExpa2UgQ2FyZCBGdW5jdGlvbmFsaXR5XG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZCkge1xuICBpZiAoIWNhcmQuX2lzTGlrZWQpIHtcbiAgICBhcGlcbiAgICAgIC5saWtlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGFwaVxuICAgICAgLnJlbW92ZUxpa2VDYXJkKGNhcmQuX2lkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLmhhbmRsZUxpa2VJY29uKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cbn1cblxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkT2JqZWN0KSA9PiB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkT2JqZWN0LFxuICAgIFwiI2NhcmRzX19saXN0LWl0ZW1cIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApO1xuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XG59O1xuXG4vLyBlbmFibGUgdXNlckluZm9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgdXNlck5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHVzZXJBYm91dDogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgdXNlckF2YXRhcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXG59KTtcblxuLy8gZW5hYmxlIEFQSSBjYWxsc1xuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiYTkzZWJkMmYtZmQwNi00OTlmLWIyZjktNzRlMmY4NTE5NzA5XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLy8gUmVuZGVyIHVzZXIgaW5mbyBhbmQgY2FyZHMgb24gcGFnZSBsb2FkXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXIoKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSkudGhlbigoW2RhdGEsIGNhcmRzXSkgPT4ge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IGRhdGEubmFtZSwgYWJvdXQ6IGRhdGEuYWJvdXQgfSk7XG4gIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoZGF0YS5hdmF0YXIsIGRhdGEubmFtZSk7XG4gIGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgeyBkYXRhOiBjYXJkcywgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSxcbiAgICBcIi5jYXJkc19fbGlzdFwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICk7XG4gIGNhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XG59KTtcblxuLy8gZW5hYmxpbmcgdmFsaWRhdGlvbiBieSBjYWxsaW5nIGVuYWJsZVZhbGlkYXRpb24oKVxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVFZGl0Rm9ybSk7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZENhcmRGb3JtKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhdmF0YXJGb3JtKTtcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBFZGl0aW5nIFByb2ZpbGUgSW50ZXJhY3Rpb25cbi8vIEVkaXQgUHJvZmlsZSBJbmZvcm1hdGlvblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLCAoZGF0YSkgPT4ge1xuICBlZGl0UHJvZmlsZVBvcHVwLnNldFN1Ym1pdFRleHQodHJ1ZSk7XG4gIGNvbnNvbGUubG9nKGRhdGEpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZShkYXRhKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IGVkaXRQcm9maWxlUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xufSk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIE9uIGNsaWNrIGV2ZW50IGZvciBlZGl0UHJvZmlsZSBidXR0b25cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIGlucHV0RGVzY3JpcHRpb24udmFsdWUgPSB1c2VyRGF0YS5hYm91dDtcbiAgbGV0IG5ld0luZm8gPSB7IG5hbWU6IGlucHV0TmFtZS52YWx1ZSwgYWJvdXQ6IGlucHV0RGVzY3JpcHRpb24udmFsdWUgfTtcbiAgdXNlckluZm8uc2V0VXNlckluZm8obmV3SW5mbyk7XG59KTtcblxuLy8gTmV3IENhcmQgSW50ZXJhY3Rpb25cbi8vIEFkZCBuZXcgY2FyZFxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtYWRkLW1vZGFsXCIsXG4gICh7IHRpdGxlLCBpbWFnZSB9KSA9PiB7XG4gICAgbmV3Q2FyZFBvcHVwLnNldFN1Ym1pdFRleHQodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuYWRkQ2FyZCh0aXRsZSwgaW1hZ2UpXG4gICAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgICBuZXdDYXJkID0gY3JlYXRlQ2FyZCh7XG4gICAgICAgICAgbmFtZTogY2FyZC5uYW1lLFxuICAgICAgICAgIGxpbms6IGNhcmQubGluayxcbiAgICAgICAgICBfaWQ6IGNhcmQuX2lkLFxuICAgICAgICAgIGlzTGlrZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgICAgY2FyZExpc3QuYWRkSXRlbShuZXdDYXJkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IG5ld0NhcmRQb3B1cC5zZXRTdWJtaXRUZXh0KGZhbHNlKSk7XG4gIH1cbik7XG5uZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gT24gY2xpY2sgZXZlbnQgZm9yIGFkZENhcmQgYnV0dG9uXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICBuZXdDYXJkUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIFByb2ZpbGUgUGljdHVyZSBJbnRlcmFjdGlvblxuLy8gVXBkYXRlIFByb2ZpbGUgUGljdHVyZVxuY29uc3QgdXBkYXRlQXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiN1cGRhdGUtYXZhdGFyLW1vZGFsXCIsIChpbWFnZSkgPT4ge1xuICB1cGRhdGVBdmF0YXJQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZVBpY3R1cmUoaW1hZ2UuaW1hZ2UpXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XG4gICAgICB1cGRhdGVBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4gdXBkYXRlQXZhdGFyUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xufSk7XG51cGRhdGVBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBPbiBjbGljayBldmVudCBmb3IgdXBkYXRlIHByb2ZpbGUgcGljdHVyZVxucHJvZmlsZUF2YXRhckVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIHVwZGF0ZUF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBFeGlzdGluZyBDYXJkIEludGVyYWN0aW9uXG4vLyBab29tIGluIG9uIGNhcmQgaW1hZ2VcbmNvbnN0IGNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNjYXJkLW1vZGFsXCIpO1xuY2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIERlbGV0ZSBDYXJkIFBvcHVwXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybShcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUsIFwiRGVsZXRpbmcuLi5cIik7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXG4gICAgICAuZmluYWxseSgoKSA9PiBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xuICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZSwgdXNlckFib3V0LCB1c2VyQXZhdGFyIH0pIHtcbiAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWUpO1xuICAgIHRoaXMuX3VzZXJBYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckFib3V0KTtcbiAgICB0aGlzLl91c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcbiAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihpbWFnZSwgbmFtZSkge1xuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gaW1hZ2U7XG4gICAgdGhpcy5fdXNlckF2YXRhci5hbHQgPSBuYW1lICsgXCIgYXZhdGFyXCI7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgLy8gY29uc3RydWN0b3IgYm9keVxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2F1dGhvcml6YXRpb24gPSBoZWFkZXJzLmF1dGhvcml6YXRpb247XG4gICAgdGhpcy5fY29udGVudFR5cGUgPSBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICB9XG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiYTkzZWJkMmYtZmQwNi00OTlmLWIyZjktNzRlMmY4NTE5NzA5XCIsXG4gICAgICB9LFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgLy8gLmNhdGNoKChlcnIpID0+IHtcbiAgICAvLyAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgLy8gfSk7XG4gIH1cblxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxuICBnZXRVc2VyKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXG4gICAgICB9LFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBhYm91dDogZGF0YS5hYm91dCxcbiAgICAgIH0pLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcbiAgICAgIH0sXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZENhcmQodGl0bGUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiB0aXRsZSxcbiAgICAgICAgbGluazogbGluayxcbiAgICAgIH0pLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcbiAgICAgIH0sXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZVBpY3R1cmUobGluaykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIC8vIC50aGVuKChyZXMpID0+IHtcbiAgICAvLyAgIGlmIChyZXMub2spIHtcbiAgICAvLyAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgLy8gICB9XG4gICAgLy8gICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgLy8gfSlcbiAgICAvLyAuY2F0Y2goKGVycikgPT4ge1xuICAgIC8vICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAvLyB9KTtcbiAgfVxufVxuXG4oXCJodHRwczovL3d3dy50aGVmYW1vdXNwZW9wbGUuY29tL3Byb2ZpbGVzL2ltYWdlcy9qYWNxdWVzLWNvdXN0ZWF1LTMuanBnXCIpO1xuXG4oXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL2Zyb250ZW5kLWRldmVsb3Blci9jb21tb24vYXZhdGFyLmpwZ1wiKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX190aXRsZVwiKTtcbiAgICB0aGlzLl9wb3B1cFN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gZGF0YS51cmw7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gZGF0YS50aXRsZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gZGF0YS50aXRsZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwQ29uZmlybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3BvcHVwU3VibWl0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwQ29uZmlybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgc2V0U3VibWl0VGV4dChzdWJtaXQsIHN1Ym1pdFRleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKHN1Ym1pdCkge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBzdWJtaXRUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9wb3B1cFN1Ym1pdC50ZXh0Q29udGVudCA9IFwiWWVzXCI7XG4gICAgfVxuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJuYW1lIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9pc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9nZXRDYXJkRWxlbWVudCIsIl9jYXJkRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfc2V0RXZlbnRzTGlzdGVuZXJzIiwiX2NhcmRJbWFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ1cmwiLCJfbGlrZUJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJoYW5kbGVEZWxldGVDYXJkIiwicmVtb3ZlIiwiaGFuZGxlTGlrZUljb24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJnZXRWaWV3IiwiX2NhcmRUaXRsZSIsInNyYyIsInRleHRDb250ZW50IiwiYWx0IiwiYWRkIiwiU2VjdGlvbiIsInNlbGVjdG9yIiwiZGF0YSIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImNsZWFyIiwiaW5uZXJIVE1MIiwicmVuZGVySXRlbXMiLCJyZXZlcnNlIiwiZm9yRWFjaCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZSIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfcG9wdXBTdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0U3VibWl0VGV4dCIsInN1Ym1pdCIsInN1Ym1pdFRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybSIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tWYWxpZGl0eSIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlRWRpdEZvcm0iLCJmb3JtcyIsImFkZENhcmRGb3JtIiwicHJvZmlsZUVkaXRCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dERlc2NyaXB0aW9uIiwicHJvZmlsZUFkZEJ1dHRvbiIsInByb2ZpbGVBdmF0YXJFZGl0IiwiYXZhdGFyRm9ybSIsImNhcmRMaXN0IiwibmV3Q2FyZCIsInJlbmRlckNhcmQiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjYXJkUG9wdXAiLCJjYXJkIiwiYXBpIiwicmVtb3ZlTGlrZUNhcmQiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJsaWtlQ2FyZCIsImNhcmRPYmplY3QiLCJ1c2VySW5mbyIsInVzZXJOYW1lIiwidXNlckFib3V0IiwidXNlckF2YXRhciIsIl91c2VyTmFtZSIsIl91c2VyQWJvdXQiLCJfdXNlckF2YXRhciIsImdldFVzZXJJbmZvIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJpbWFnZSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfYXV0aG9yaXphdGlvbiIsImF1dGhvcml6YXRpb24iLCJfY29udGVudFR5cGUiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiZ2V0VXNlciIsInVwZGF0ZVByb2ZpbGUiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJ0aXRsZSIsImRlbGV0ZUNhcmQiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImF2YXRhciIsIlByb21pc2UiLCJhbGwiLCJjYXJkcyIsImFkZEZvcm1WYWxpZGF0b3IiLCJlZGl0UHJvZmlsZVBvcHVwIiwibG9nIiwiZmluYWxseSIsInVzZXJEYXRhIiwibmV3SW5mbyIsIm5ld0NhcmRQb3B1cCIsIl9yZWYyIiwidXBkYXRlQXZhdGFyUG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJfcG9wdXBDb25maXJtIiwiX2hhbmRsZVN1Ym1pdCIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=