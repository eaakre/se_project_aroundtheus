!function(){"use strict";class e{constructor(e,t,s,i,r){let{name:n,link:o,_id:a,isLiked:l}=e;this._name=n,this._link=o,this._id=a,this._isLiked=l,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClick=r}_getCardElement(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".cards__list-item").cloneNode(!0)}_setEventsListeners(){this._cardImage.addEventListener("click",(()=>{this._handleImageClick({title:this._name,url:this._link})})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}handleDeleteCard=()=>{this._cardElement.remove(),this._cardElement=null};handleLikeIcon=()=>{this._likeButton.classList.toggle("cards__favorite_active")};getView(){return this._cardElement=this._getCardElement(),this._cardTitle=this._cardElement.querySelector(".cards__title"),this._cardImage=this._cardElement.querySelector(".cards__image"),this._likeButton=this._cardElement.querySelector(".cards__favorite"),this._deleteButton=this._cardElement.querySelector(".cards__delete-button"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._setEventsListeners(),this._isLiked&&this._likeButton.classList.add("cards__favorite_active"),this._cardElement}}class t{constructor(e,t){let{data:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.forEach(this._renderer)}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class i extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=this._popupElement.querySelectorAll(".form__input"),this._handleFormSubmit=t,this._popupSubmit=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=e?t:"Save"}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}close(){super.close(),this._popupForm.reset()}}class r{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e,t){const s=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){if(this._hasInvalidInput(this._inputList))return this.disableButton();this._enableButton()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_checkValidity(e){if(!e.validity.valid)return this._showInputError(e,e.validationMessage);this._hideInputError(e)}_setEventListeners(){this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const n={formSelector:".modal__form",inputSelector:".form__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},o=document.querySelector("#profile-edit-modal"),a=document.forms["edit-form"],l=document.forms["add-form"],c=document.querySelector(".profile__edit-button"),h=o.querySelector(".form__input_name"),u=o.querySelector(".form__input_description"),d=document.querySelector(".profile__add-button"),_=(document.querySelectorAll(".cards__delete-button"),document.querySelector(".profile__avatar")),m=document.querySelector(".profile__avatar-edit");let p,v;function f(e){const t=S(e);p.addItem(t)}function b(e,t){I.open(e,t)}const S=t=>new e(t,"#cards__list-item",b,B,U).getView(),E=new class{constructor(e){let{userName:t,userJob:s,userAvatar:i}=e;this._userName=document.querySelector(t),this._userJob=document.querySelector(s),this._userAvatar=document.querySelector(i)}getUserInfo(){return{name:this._userName.textContent,job:this._userJob.textContent}}setUserInfo(e){this._userName.textContent=e.name,this._userJob.textContent=e.description}setUserAvatar(e){this._userAvatar.src=e}}({userName:".profile__title",userJob:".profile__description",userAvatar:".profile__avatar"}),y=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._authorization=s.authorization,this._contentType=s["Content-Type"]}_checkResponse(e){if(e.ok)return e.json()}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:"a93ebd2f-fd06-499f-b2f9-74e2f8519709"}}).then(this._checkResponse)}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}updateProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",body:JSON.stringify({name:e.name,about:e.description}),headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}addCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",body:JSON.stringify({name:e,link:t}),headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}removeLikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":this._contentType},body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a93ebd2f-fd06-499f-b2f9-74e2f8519709","Content-Type":"application/json"}});y.getUser().then((e=>{E.setUserInfo({name:e.name,description:e.about}),_.src=e.avatar,_.alt=e.name+" avatar"})),y.getInitialCards().then((e=>{p=new t({data:e,renderer:f},".cards__list",b,B,U),p.renderItems()}));const C=new r(n,a),L=new r(n,l);L.enableValidation(),C.enableValidation();const k=new i("#profile-edit-modal",(function(e){y.updateProfile({name:e.title,description:e.description}).then(y.getUser().then((e=>{E.setUserInfo({name:e.name,description:e.about,avatar:e.avatar})}))),k.close()}));k.setEventListeners(),c.addEventListener("click",(()=>{k.open();const e=E.getUserInfo();h.value=e.name,u.value=e.job;let t={name:h.value,description:u.value};E.setUserInfo(t)}));const g=new i("#profile-add-modal",(e=>{let{title:t,image:s}=e;g.setSubmitText(!0),y.addCard(t,s).then((e=>{v=S({name:e.name,link:e.link}),p.addItem(v)})).catch((e=>console.log(e))).finally((()=>g.setSubmitText(!1)))}));g.setEventListeners(),d.addEventListener("click",(()=>{L.disableButton(),g.open()}));const T=new i("#update-avatar-modal",(e=>{T.setSubmitText(!0),y.updateProfilePicture(e.image).then((e=>{E.setUserAvatar(e.avatar),T.close()})).catch((e=>console.log(e))).finally((()=>T.setSubmitText(!1)))}));T.setEventListeners(),m.addEventListener("click",(()=>{L.disableButton(),T.open()}));const I=new class extends s{constructor(e){super({popupSelector:e}),this._cardImage=document.querySelector(".modal__image"),this._cardTitle=document.querySelector(".modal__title"),this._popupSubmit=this._popupElement.querySelector(".modal__button")}open(e){this._cardImage.src=e.url,this._cardTitle.textContent=e.title,this._cardImage.alt=e.title,super.open()}}("#card-modal");I.setEventListeners();const q=new class extends s{constructor(e){super({popupSelector:e}),this._popupConfirm=this._popupElement.querySelector(".modal__form"),this._popupSubmit=this._popupElement.querySelector(".modal__button")}setEventListeners(){this._popupConfirm.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=e?t:"Yes"}setSubmitAction(e){this._handleSubmit=e}}("#delete-card-modal");function B(e){q.open(),q.setSubmitAction((()=>{q.setSubmitText(!0,"Deleting..."),y.deleteCard(e._id).then((()=>{q.close(),e.handleDeleteCard()})).catch((e=>console.error(e))).finally((()=>q.setSubmitText(!1)))}))}function U(e){e._isLiked?y.removeLikeCard(e._id).then((()=>{e.handleLikeIcon()})).catch((e=>{console.error(e)})):y.likeCard(e._id).then((()=>{e.handleLikeIcon()})).catch((e=>{console.error(e)}))}q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVFTLE1BQU1WLEtBQzdCRyxTQUFRLElBQU1FLEVBQWdCcEgsZUFBYyxJQUFPLEdBRTFELENBR0EsU0FBUzFFLEVBQWdCdUwsR0FDbEJBLEVBQUsvSyxTQVVSNEksRUFDR3dCLGVBQWVXLEVBQUtwTCxLQUNwQjhKLE1BQUssS0FDSnNCLEVBQUszSixnQkFBZ0IsSUFFdEI0SixPQUFPQyxJQUNOQyxRQUFRUyxNQUFNVixFQUFJLElBZnRCckMsRUFDR3VCLFNBQVNZLEVBQUtwTCxLQUNkOEosTUFBSyxLQUNKc0IsRUFBSzNKLGdCQUFnQixJQUV0QjRKLE9BQU9DLElBQ05DLFFBQVFTLE1BQU1WLEVBQUksR0FZMUIsQ0F0Q0FLLEVBQWdCbEksbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9wb3B1cFdpdGhDb25maXJtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9pZCA9IF9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICBfZ2V0Q2FyZEVsZW1lbnQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0LWl0ZW1cIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG4gIF9zZXRFdmVudHNMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgdGl0bGU6IHRoaXMuX25hbWUsIHVybDogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcbiAgICB9KTtcbiAgICAvLyB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlSWNvbik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICAgIC8vIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCk7XG4gICAgfSk7XG4gIH1cblxuICBoYW5kbGVEZWxldGVDYXJkID0gKCkgPT4ge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfTtcblxuICBoYW5kbGVMaWtlSWNvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICB9O1xuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRDYXJkRWxlbWVudCgpO1xuXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZmF2b3JpdGVcIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50c0xpc3RlbmVycygpO1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9wb3B1cFN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZGF0YSA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgc2V0U3VibWl0VGV4dChzdWJtaXQsIHN1Ym1pdFRleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKHN1Ym1pdCkge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBzdWJtaXRUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9wb3B1cFN1Ym1pdC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm0pIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0TGlzdC5ldmVyeShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICk7XG4gIH1cblxuICBfY2hlY2tWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja1ZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIkRpc25leSBXb3JsZFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1OTc0NjY1OTkzNjAtM2I5Nzc1ODQxYWVjP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTc2NCZxPTgwXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkdvb3NlYmVycnkgRmFsbHNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjE4NTAyMTA1NjM0LWRkYjI4Yzc0OGRkYj9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz02ODcmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJXaWxsaXMgVG93ZXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTU2NDcyOTA4LTBmNzdlODE1ZDgxYj9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03NjQmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHYXRld2F5IEFyY2hcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTkzNTY5MjQ4ODA1LTE4MjU0MmY4MmMxND9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03MTUmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJFc3RlcyBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUyMDA1MDczNTA4Ny0xZWQ2NWQ5YjAyNzM/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzM1JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR2xhY2llciBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ3MTg5MzM3MDA1MC0yYzFhMzZjZjU1NWM/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTE3OCZxPTgwXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbi8vIFdyYXBwZXJzXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuXG4vLyBGb3Jtc1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1mb3JtXCJdO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtZm9ybVwiXTtcblxuLy8gRmluZCBvcGVuIGFuZCBjbG9zZSBidXR0b25zIGZvciBlZGl0IHByb2ZpbGUgYnV0dG9uXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF9uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IGlucHV0RGVzY3JpcHRpb24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLmZvcm1fX2lucHV0X2Rlc2NyaXB0aW9uXCJcbik7XG5cbi8vIEZpbmQgb3Blbi9jbG9zZS9mb3JtIGZpZWxkcyBmb3IgYWRkIHByb2ZpbGUgYnV0dG9uXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgXCIuY2FyZHNfX2RlbGV0ZS1idXR0b25cIlxuKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0XCJcbik7XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL3BvcHVwV2l0aENvbmZpcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7XG4gIGNvbmZpZyxcbiAgcHJvZmlsZUVkaXRGb3JtLFxuICBhZGRDYXJkRm9ybSxcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIGlucHV0TmFtZSxcbiAgaW5wdXREZXNjcmlwdGlvbixcbiAgcHJvZmlsZUFkZEJ1dHRvbixcbiAgcHJvZmlsZUF2YXRhcixcbiAgcHJvZmlsZUF2YXRhckVkaXQsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmxldCBjYXJkTGlzdDtcbmxldCBuZXdDYXJkO1xuXG4vLyBGdW5jdGlvbnNcbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KGRhdGEpIHtcbiAgYXBpXG4gICAgLnVwZGF0ZVByb2ZpbGUoe1xuICAgICAgbmFtZTogZGF0YS50aXRsZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgIH0pXG4gICAgLnRoZW4oXG4gICAgICBhcGkuZ2V0VXNlcigpLnRoZW4oKGluZm8pID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICAgIG5hbWU6IGluZm8ubmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogaW5mby5hYm91dCxcbiAgICAgICAgICBhdmF0YXI6IGluZm8uYXZhdGFyLFxuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgKTtcbiAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xufVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobmFtZSwgbGluaykge1xuICBjYXJkUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcbn1cblxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkT2JqZWN0KSA9PiB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkT2JqZWN0LFxuICAgIFwiI2NhcmRzX19saXN0LWl0ZW1cIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApO1xuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XG59O1xuXG4vLyBlbmFibGUgdXNlckluZm9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgdXNlck5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHVzZXJKb2I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIHVzZXJBdmF0YXI6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxufSk7XG5cbi8vIGVuYWJsZSBBUEkgY2FsbHNcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImE5M2ViZDJmLWZkMDYtNDk5Zi1iMmY5LTc0ZTJmODUxOTcwOVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vIFJlbmRlciB1c2VyIGluZm8gb24gcGFnZSBsb2FkXG5hcGkuZ2V0VXNlcigpLnRoZW4oKGluZm8pID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgIG5hbWU6IGluZm8ubmFtZSxcbiAgICBkZXNjcmlwdGlvbjogaW5mby5hYm91dCxcbiAgfSk7XG4gIHByb2ZpbGVBdmF0YXIuc3JjID0gaW5mby5hdmF0YXI7XG4gIHByb2ZpbGVBdmF0YXIuYWx0ID0gaW5mby5uYW1lICsgXCIgYXZhdGFyXCI7XG59KTtcblxuLy8gUmVuZGVyIGNhcmRzIG9uIHBhZ2UgbG9hZFxuYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKGluaXRpYWxDYXJkcykgPT4ge1xuICBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgIHsgZGF0YTogaW5pdGlhbENhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxuICAgIFwiLmNhcmRzX19saXN0XCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgY2FyZExpc3QucmVuZGVySXRlbXMoKTtcbn0pO1xuXG4vLyBlbmFibGluZyB2YWxpZGF0aW9uIGJ5IGNhbGxpbmcgZW5hYmxlVmFsaWRhdGlvbigpXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUVkaXRGb3JtKTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZENhcmRGb3JtKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBFZGl0aW5nIFByb2ZpbGUgSW50ZXJhY3Rpb25cbi8vIEVkaXQgUHJvZmlsZSBJbmZvcm1hdGlvblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlRWRpdFByb2ZpbGVTdWJtaXRcbik7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIE9uIGNsaWNrIGV2ZW50IGZvciBlZGl0UHJvZmlsZSBidXR0b25cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIGlucHV0RGVzY3JpcHRpb24udmFsdWUgPSB1c2VyRGF0YS5qb2I7XG4gIGxldCBuZXdJbmZvID0geyBuYW1lOiBpbnB1dE5hbWUudmFsdWUsIGRlc2NyaXB0aW9uOiBpbnB1dERlc2NyaXB0aW9uLnZhbHVlIH07XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5ld0luZm8pO1xufSk7XG5cbi8vIE5ldyBDYXJkIEludGVyYWN0aW9uXG4vLyBBZGQgbmV3IGNhcmRcbmNvbnN0IG5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWFkZC1tb2RhbFwiLFxuICAoeyB0aXRsZSwgaW1hZ2UgfSkgPT4ge1xuICAgIG5ld0NhcmRQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUpO1xuICAgIGFwaVxuICAgICAgLmFkZENhcmQodGl0bGUsIGltYWdlKVxuICAgICAgLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgICAgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoeyBuYW1lOiBjYXJkLm5hbWUsIGxpbms6IGNhcmQubGluayB9KTtcbiAgICAgICAgY2FyZExpc3QuYWRkSXRlbShuZXdDYXJkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IG5ld0NhcmRQb3B1cC5zZXRTdWJtaXRUZXh0KGZhbHNlKSk7XG4gIH1cbik7XG5uZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gT24gY2xpY2sgZXZlbnQgZm9yIGFkZENhcmQgYnV0dG9uXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICBuZXdDYXJkUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIFByb2ZpbGUgUGljdHVyZSBJbnRlcmFjdGlvblxuLy8gVXBkYXRlIFByb2ZpbGUgUGljdHVyZVxuY29uc3QgdXBkYXRlQXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiN1cGRhdGUtYXZhdGFyLW1vZGFsXCIsIChpbWFnZSkgPT4ge1xuICB1cGRhdGVBdmF0YXJQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZVBpY3R1cmUoaW1hZ2UuaW1hZ2UpXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XG4gICAgICB1cGRhdGVBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4gdXBkYXRlQXZhdGFyUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xufSk7XG51cGRhdGVBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBPbiBjbGljayBldmVudCBmb3IgdXBkYXRlIHByb2ZpbGUgcGljdHVyZVxucHJvZmlsZUF2YXRhckVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIHVwZGF0ZUF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBFeGlzdGluZyBDYXJkIEludGVyYWN0aW9uXG4vLyBab29tIGluIG9uIGNhcmQgaW1hZ2VcbmNvbnN0IGNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNjYXJkLW1vZGFsXCIpO1xuY2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIERlbGV0ZSBDYXJkIFBvcHVwXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybShcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRUZXh0KHRydWUsIFwiRGVsZXRpbmcuLi5cIik7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXG4gICAgICAuZmluYWxseSgoKSA9PiBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xuICB9KTtcbn1cblxuLy8gTGlrZSBDYXJkIEZ1bmN0aW9uYWxpdHlcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGlmICghY2FyZC5faXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuX2lkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLmhhbmRsZUxpa2VJY29uKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgYXBpXG4gICAgICAucmVtb3ZlTGlrZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuaGFuZGxlTGlrZUljb24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lLCB1c2VySm9iLCB1c2VyQXZhdGFyIH0pIHtcbiAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWUpO1xuICAgIHRoaXMuX3VzZXJKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJKb2IpO1xuICAgIHRoaXMuX3VzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBdmF0YXIpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHsgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsIGpvYjogdGhpcy5fdXNlckpvYi50ZXh0Q29udGVudCB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oZGF0YSkge1xuICAgIHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX3VzZXJKb2IudGV4dENvbnRlbnQgPSBkYXRhLmRlc2NyaXB0aW9uO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihpbWFnZSkge1xuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gaW1hZ2U7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgLy8gY29uc3RydWN0b3IgYm9keVxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2F1dGhvcml6YXRpb24gPSBoZWFkZXJzLmF1dGhvcml6YXRpb247XG4gICAgdGhpcy5fY29udGVudFR5cGUgPSBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICB9XG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiYTkzZWJkMmYtZmQwNi00OTlmLWIyZjktNzRlMmY4NTE5NzA5XCIsXG4gICAgICB9LFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgLy8gLmNhdGNoKChlcnIpID0+IHtcbiAgICAvLyAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgLy8gfSk7XG4gIH1cblxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxuICBnZXRVc2VyKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXG4gICAgICB9LFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBhYm91dDogZGF0YS5kZXNjcmlwdGlvbixcbiAgICAgIH0pLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcbiAgICAgIH0sXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZENhcmQodGl0bGUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiB0aXRsZSxcbiAgICAgICAgbGluazogbGluayxcbiAgICAgIH0pLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcbiAgICAgIH0sXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZVBpY3R1cmUobGluaykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIC8vIC50aGVuKChyZXMpID0+IHtcbiAgICAvLyAgIGlmIChyZXMub2spIHtcbiAgICAvLyAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgLy8gICB9XG4gICAgLy8gICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgLy8gfSlcbiAgICAvLyAuY2F0Y2goKGVycikgPT4ge1xuICAgIC8vICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAvLyB9KTtcbiAgfVxufVxuXG4oXCJodHRwczovL3d3dy50aGVmYW1vdXNwZW9wbGUuY29tL3Byb2ZpbGVzL2ltYWdlcy9qYWNxdWVzLWNvdXN0ZWF1LTMuanBnXCIpO1xuXG4oXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL2Zyb250ZW5kLWRldmVsb3Blci9jb21tb24vYXZhdGFyLmpwZ1wiKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX190aXRsZVwiKTtcbiAgICB0aGlzLl9wb3B1cFN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gZGF0YS51cmw7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gZGF0YS50aXRsZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gZGF0YS50aXRsZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwQ29uZmlybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3BvcHVwU3VibWl0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwQ29uZmlybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgc2V0U3VibWl0VGV4dChzdWJtaXQsIHN1Ym1pdFRleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKHN1Ym1pdCkge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBzdWJtaXRUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9wb3B1cFN1Ym1pdC50ZXh0Q29udGVudCA9IFwiWWVzXCI7XG4gICAgfVxuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJuYW1lIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9pc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9nZXRDYXJkRWxlbWVudCIsIl9jYXJkRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfc2V0RXZlbnRzTGlzdGVuZXJzIiwiX2NhcmRJbWFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0aXRsZSIsInVybCIsIl9saWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsImhhbmRsZURlbGV0ZUNhcmQiLCJyZW1vdmUiLCJoYW5kbGVMaWtlSWNvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImdldFZpZXciLCJfY2FyZFRpdGxlIiwic3JjIiwidGV4dENvbnRlbnQiLCJhbHQiLCJhZGQiLCJTZWN0aW9uIiwic2VsZWN0b3IiLCJkYXRhIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2xlYXIiLCJpbm5lckhUTUwiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3BvcHVwU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldFN1Ym1pdFRleHQiLCJzdWJtaXQiLCJzdWJtaXRUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm0iLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrVmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUVkaXRGb3JtIiwiZm9ybXMiLCJhZGRDYXJkRm9ybSIsInByb2ZpbGVFZGl0QnV0dG9uIiwiaW5wdXROYW1lIiwiaW5wdXREZXNjcmlwdGlvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJwcm9maWxlQXZhdGFyIiwicHJvZmlsZUF2YXRhckVkaXQiLCJjYXJkTGlzdCIsIm5ld0NhcmQiLCJyZW5kZXJDYXJkIiwiY2FyZEVsZW1lbnQiLCJjcmVhdGVDYXJkIiwiY2FyZFBvcHVwIiwiY2FyZE9iamVjdCIsInVzZXJJbmZvIiwidXNlck5hbWUiLCJ1c2VySm9iIiwidXNlckF2YXRhciIsIl91c2VyTmFtZSIsIl91c2VySm9iIiwiX3VzZXJBdmF0YXIiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwiZGVzY3JpcHRpb24iLCJzZXRVc2VyQXZhdGFyIiwiaW1hZ2UiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2F1dGhvcml6YXRpb24iLCJhdXRob3JpemF0aW9uIiwiX2NvbnRlbnRUeXBlIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VyIiwidXBkYXRlUHJvZmlsZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGRDYXJkIiwiZGVsZXRlQ2FyZCIsImxpa2VDYXJkIiwicmVtb3ZlTGlrZUNhcmQiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImF2YXRhciIsImluZm8iLCJpbml0aWFsQ2FyZHMiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJlZGl0UHJvZmlsZVBvcHVwIiwidXNlckRhdGEiLCJuZXdJbmZvIiwibmV3Q2FyZFBvcHVwIiwiY2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJ1cGRhdGVBdmF0YXJQb3B1cCIsImRlbGV0ZUNhcmRQb3B1cCIsIl9wb3B1cENvbmZpcm0iLCJfaGFuZGxlU3VibWl0Iiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9