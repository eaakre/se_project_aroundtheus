!function(){"use strict";class t{constructor(t,e,s,i,r){let{name:n,link:o,_id:a,isLiked:l}=t;this._name=n,this._link=o,this._id=a,this._isLiked=l,this._cardSelector=e,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClick=r}_getCardElement(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".cards__list-item").cloneNode(!0)}_setEventsListeners(){this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,url:this._link})})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}handleDeleteCard=()=>{this._cardElement.remove(),this._cardElement=null};handleLikeIcon=()=>{this._likeButton.classList.toggle("cards__favorite_active")};getView(){return this._cardElement=this._getCardElement(),this._cardTitle=this._cardElement.querySelector(".cards__title"),this._cardImage=this._cardElement.querySelector(".cards__image"),this._likeButton=this._cardElement.querySelector(".cards__favorite"),this._deleteButton=this._cardElement.querySelector(".cards__delete-button"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._setEventsListeners(),this._isLiked&&this._likeButton.classList.add("cards__favorite_active"),this._cardElement}}class e{constructor(t,e){let{data:s,renderer:i}=t;this._items=s,this._renderer=i,this._container=document.querySelector(e)}addItem(t){this._container.prepend(t)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.forEach(this._renderer)}}class s{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(t=>{(t.target.classList.contains("modal_opened")||t.target.classList.contains("modal__close"))&&this.close()}))}}class i extends s{constructor(t,e){super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=this._popupElement.querySelectorAll(".form__input"),this._handleFormSubmit=e,this._popupSubmit=this._popupElement.querySelector(".modal__button")}_getInputValues(){const t={};return this._inputList.forEach((e=>{t[e.name]=e.value})),t}setSubmitText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=t?e:"Save"}setEventListeners(){this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}close(){super.close(),this._popupForm.reset()}}class r{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._form=e}_showInputError(t,e){const s=this._form.querySelector(`.${t.id}-error`);t.classList.add(this._inputErrorClass),s.textContent=e,s.classList.add(this._errorClass)}_hideInputError(t){const e=this._form.querySelector(`.${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}_toggleButtonState(){if(this._hasInvalidInput(this._inputList))return this.disableButton();this._enableButton()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(){return!this._inputList.every((t=>t.validity.valid))}_checkValidity(t){if(!t.validity.valid)return this._showInputError(t,t.validationMessage);this._hideInputError(t)}_setEventListeners(){this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkValidity(t),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}}const n={formSelector:".modal__form",inputSelector:".form__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},o=document.querySelector("#profile-edit-modal"),a=document.forms["edit-form"],l=document.forms["add-form"],c=document.querySelector(".profile__edit-button"),u=o.querySelector(".form__input_name"),h=o.querySelector(".form__input_description"),d=document.querySelector(".profile__add-button"),_=(document.querySelectorAll(".cards__delete-button"),document.querySelector(".profile__avatar"),document.querySelector(".profile__avatar-edit")),m=document.forms["update-avatar-form"];let p,b;function v(t){const e=E(t);p.addItem(e)}function f(t,e){I.open(t,e)}function S(t){t._isLiked?C.removeLikeCard(t._id).then((()=>{t.handleLikeIcon()})).catch((t=>{console.error(t)})):C.likeCard(t._id).then((()=>{t.handleLikeIcon()})).catch((t=>{console.error(t)}))}const E=e=>new t(e,"#cards__list-item",f,B,S).getView(),y=new class{constructor(t){let{userName:e,userAbout:s,userAvatar:i}=t;this._userName=document.querySelector(e),this._userAbout=document.querySelector(s),this._userAvatar=document.querySelector(i)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent}}setUserInfo(t){this._userName.textContent=t.name,this._userAbout.textContent=t.about}setUserAvatar(t,e){this._userAvatar.src=t,this._userAvatar.alt=e+" avatar"}}({userName:".profile__title",userAbout:".profile__description",userAvatar:".profile__avatar"}),C=new class{constructor(t){let{baseUrl:e,headers:s}=t;this._baseUrl=e,this._authorization=s.authorization,this._contentType=s["Content-Type"]}_checkResponse(t){if(t.ok)return t.json()}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:"a93ebd2f-fd06-499f-b2f9-74e2f8519709"}}).then(this._checkResponse)}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}updateProfile(t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",body:JSON.stringify({name:t.name,about:t.about}),headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}addCard(t,e){return fetch(`${this._baseUrl}/cards`,{method:"POST",body:JSON.stringify({name:t,link:e}),headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}deleteCard(t){return fetch(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}likeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"PUT",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}removeLikeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":this._contentType}}).then(this._checkResponse)}updateProfilePicture(t){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":this._contentType},body:JSON.stringify({avatar:t})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a93ebd2f-fd06-499f-b2f9-74e2f8519709","Content-Type":"application/json"}});Promise.all([C.getUser(),C.getInitialCards()]).then((t=>{let[s,i]=t;y.setUserInfo({name:s.name,about:s.about}),y.setUserAvatar(s.avatar,s.name),p=new e({data:i,renderer:v},".cards__list",f,B,S),p.renderItems()})),new r(n,a).enableValidation();const L=new r(n,l);L.enableValidation(),new r(n,m).enableValidation();const k=new i("#profile-edit-modal",(t=>{k.setSubmitText(!0),console.log(t),C.updateProfile(t).then((t=>{y.setUserInfo(t),k.close()})).finally((()=>k.setSubmitText(!1)))}));k.setEventListeners(),c.addEventListener("click",(()=>{k.open();const t=y.getUserInfo();u.value=t.name,h.value=t.about;let e={name:u.value,about:h.value};y.setUserInfo(e)}));const g=new i("#profile-add-modal",(t=>{let{title:e,image:s}=t;g.setSubmitText(!0),C.addCard(e,s).then((t=>{b=E({name:t.name,link:t.link}),p.addItem(b)})).catch((t=>console.log(t))).finally((()=>g.setSubmitText(!1)))}));g.setEventListeners(),d.addEventListener("click",(()=>{L.disableButton(),g.open()}));const T=new i("#update-avatar-modal",(t=>{T.setSubmitText(!0),C.updateProfilePicture(t.image).then((t=>{y.setUserAvatar(t.avatar),T.close()})).catch((t=>console.log(t))).finally((()=>T.setSubmitText(!1)))}));T.setEventListeners(),_.addEventListener("click",(()=>{L.disableButton(),T.open()}));const I=new class extends s{constructor(t){super({popupSelector:t}),this._cardImage=document.querySelector(".modal__image"),this._cardTitle=document.querySelector(".modal__title"),this._popupSubmit=this._popupElement.querySelector(".modal__button")}open(t){this._cardImage.src=t.url,this._cardTitle.textContent=t.title,this._cardImage.alt=t.title,super.open()}}("#card-modal");I.setEventListeners();const q=new class extends s{constructor(t){super({popupSelector:t}),this._popupConfirm=this._popupElement.querySelector(".modal__form"),this._popupSubmit=this._popupElement.querySelector(".modal__button")}setEventListeners(){this._popupConfirm.addEventListener("submit",(t=>{t.preventDefault(),this._handleSubmit()})),super.setEventListeners()}setSubmitText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupSubmit.textContent=t?e:"Yes"}setSubmitAction(t){this._handleSubmit=t}}("#delete-card-modal");function B(t){q.open(),q.setSubmitAction((()=>{q.setSubmitText(!0,"Deleting..."),C.deleteCard(t._id).then((()=>{q.close(),t.handleDeleteCard()})).catch((t=>console.error(t))).finally((()=>q.setSubmitText(!1)))}))}q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxhQUFhcEMsWUFEaEJ5QyxFQUM4QkMsRUFFQSxLQUVwQyxDQUVBc0gsZUFBQUEsQ0FBZ0JDLEdBQ2Q3TCxLQUFLMkwsY0FBZ0JFLENBQ3ZCLEdKOEoyQyxzQkFHN0MsU0FBU25NLEVBQWtCc0ksR0FDekJ5RCxFQUFnQnpJLE9BQ2hCeUksRUFBZ0JHLGlCQUFnQixLQUM5QkgsRUFBZ0JySCxlQUFjLEVBQU0sZUFDcEM2RCxFQUNHeUMsV0FBVzFDLEVBQUtsSSxLQUNoQnFJLE1BQUssS0FDSnNELEVBQWdCdkksUUFDaEI4RSxFQUFLNUcsa0JBQWtCLElBRXhCZ0gsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTUYsS0FDN0I4QyxTQUFRLElBQU1NLEVBQWdCckgsZUFBYyxJQUFPLEdBRTFELENBZkFxSCxFQUFnQm5JLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvcG9wdXBXaXRoQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgeyBuYW1lLCBsaW5rLCBfaWQsIGlzTGlrZWQgfSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5faWQgPSBfaWQ7XG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG5cbiAgX2dldENhcmRFbGVtZW50KCkge1xuICAgIHJldHVybiAodGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdC1pdGVtXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpKTtcbiAgfVxuICBfc2V0RXZlbnRzTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIHVybDogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcbiAgICB9KTtcbiAgICAvLyB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlSWNvbik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICAgIC8vIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCk7XG4gICAgfSk7XG4gIH1cblxuICBoYW5kbGVEZWxldGVDYXJkID0gKCkgPT4ge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfTtcblxuICBoYW5kbGVMaWtlSWNvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICB9O1xuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRDYXJkRWxlbWVudCgpO1xuXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZmF2b3JpdGVcIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50c0xpc3RlbmVycygpO1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkc19fZmF2b3JpdGVfYWN0aXZlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9wb3B1cFN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZGF0YSA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgc2V0U3VibWl0VGV4dChzdWJtaXQsIHN1Ym1pdFRleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKHN1Ym1pdCkge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBzdWJtaXRUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9wb3B1cFN1Ym1pdC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm0pIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0TGlzdC5ldmVyeShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICk7XG4gIH1cblxuICBfY2hlY2tWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja1ZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIkRpc25leSBXb3JsZFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1OTc0NjY1OTkzNjAtM2I5Nzc1ODQxYWVjP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTc2NCZxPTgwXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkdvb3NlYmVycnkgRmFsbHNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjE4NTAyMTA1NjM0LWRkYjI4Yzc0OGRkYj9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz02ODcmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJXaWxsaXMgVG93ZXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTU2NDcyOTA4LTBmNzdlODE1ZDgxYj9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03NjQmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHYXRld2F5IEFyY2hcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTkzNTY5MjQ4ODA1LTE4MjU0MmY4MmMxND9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03MTUmcT04MFwiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJFc3RlcyBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUyMDA1MDczNTA4Ny0xZWQ2NWQ5YjAyNzM/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzM1JnE9ODBcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR2xhY2llciBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ3MTg5MzM3MDA1MC0yYzFhMzZjZjU1NWM/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTE3OCZxPTgwXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbi8vIFdyYXBwZXJzXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuXG4vLyBGb3Jtc1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1mb3JtXCJdO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtZm9ybVwiXTtcblxuLy8gRmluZCBvcGVuIGFuZCBjbG9zZSBidXR0b25zIGZvciBlZGl0IHByb2ZpbGUgYnV0dG9uXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF9uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IGlucHV0RGVzY3JpcHRpb24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLmZvcm1fX2lucHV0X2Rlc2NyaXB0aW9uXCJcbik7XG5cbi8vIEZpbmQgb3Blbi9jbG9zZS9mb3JtIGZpZWxkcyBmb3IgYWRkIHByb2ZpbGUgYnV0dG9uXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgXCIuY2FyZHNfX2RlbGV0ZS1idXR0b25cIlxuKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0XCJcbik7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1widXBkYXRlLWF2YXRhci1mb3JtXCJdO1xuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9wb3B1cFdpdGhDb25maXJtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQge1xuICBjb25maWcsXG4gIHByb2ZpbGVFZGl0Rm9ybSxcbiAgYWRkQ2FyZEZvcm0sXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBpbnB1dE5hbWUsXG4gIGlucHV0RGVzY3JpcHRpb24sXG4gIHByb2ZpbGVBZGRCdXR0b24sXG4gIHByb2ZpbGVBdmF0YXIsXG4gIHByb2ZpbGVBdmF0YXJFZGl0LFxuICBhdmF0YXJGb3JtLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG5sZXQgY2FyZExpc3Q7XG5sZXQgbmV3Q2FyZDtcblxuLy8gRnVuY3Rpb25zXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobmFtZSwgbGluaykge1xuICBjYXJkUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcbn1cblxuLy8gTGlrZSBDYXJkIEZ1bmN0aW9uYWxpdHlcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGlmICghY2FyZC5faXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuX2lkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLmhhbmRsZUxpa2VJY29uKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgYXBpXG4gICAgICAucmVtb3ZlTGlrZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuaGFuZGxlTGlrZUljb24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBjcmVhdGVDYXJkID0gKGNhcmRPYmplY3QpID0+IHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmRPYmplY3QsXG4gICAgXCIjY2FyZHNfX2xpc3QtaXRlbVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn07XG5cbi8vIGVuYWJsZSB1c2VySW5mb1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICB1c2VyTmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgdXNlckFib3V0OiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICB1c2VyQXZhdGFyOiBcIi5wcm9maWxlX19hdmF0YXJcIixcbn0pO1xuXG4vLyBlbmFibGUgQVBJIGNhbGxzXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhOTNlYmQyZi1mZDA2LTQ5OWYtYjJmOS03NGUyZjg1MTk3MDlcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBSZW5kZXIgdXNlciBpbmZvIGFuZCBjYXJkcyBvbiBwYWdlIGxvYWRcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlcigpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKS50aGVuKChbZGF0YSwgY2FyZHNdKSA9PiB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogZGF0YS5uYW1lLCBhYm91dDogZGF0YS5hYm91dCB9KTtcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcihkYXRhLmF2YXRhciwgZGF0YS5uYW1lKTtcbiAgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAgICB7IGRhdGE6IGNhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxuICAgIFwiLmNhcmRzX19saXN0XCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgY2FyZExpc3QucmVuZGVySXRlbXMoKTtcbn0pO1xuXG4vLyBlbmFibGluZyB2YWxpZGF0aW9uIGJ5IGNhbGxpbmcgZW5hYmxlVmFsaWRhdGlvbigpXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUVkaXRGb3JtKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYWRkQ2FyZEZvcm0pO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGF2YXRhckZvcm0pO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIEVkaXRpbmcgUHJvZmlsZSBJbnRlcmFjdGlvblxuLy8gRWRpdCBQcm9maWxlIEluZm9ybWF0aW9uXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsIChkYXRhKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAuc2V0U3VibWl0VGV4dCh0cnVlKTtcbiAgY29uc29sZS5sb2coZGF0YSk7XG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlKGRhdGEpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4gZWRpdFByb2ZpbGVQb3B1cC5zZXRTdWJtaXRUZXh0KGZhbHNlKSk7XG59KTtcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gT24gY2xpY2sgZXZlbnQgZm9yIGVkaXRQcm9maWxlIGJ1dHRvblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgaW5wdXROYW1lLnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgaW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHVzZXJEYXRhLmFib3V0O1xuICBsZXQgbmV3SW5mbyA9IHsgbmFtZTogaW5wdXROYW1lLnZhbHVlLCBhYm91dDogaW5wdXREZXNjcmlwdGlvbi52YWx1ZSB9O1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhuZXdJbmZvKTtcbn0pO1xuXG4vLyBOZXcgQ2FyZCBJbnRlcmFjdGlvblxuLy8gQWRkIG5ldyBjYXJkXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcbiAgKHsgdGl0bGUsIGltYWdlIH0pID0+IHtcbiAgICBuZXdDYXJkUG9wdXAuc2V0U3VibWl0VGV4dCh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKHRpdGxlLCBpbWFnZSlcbiAgICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgIG5ld0NhcmQgPSBjcmVhdGVDYXJkKHsgbmFtZTogY2FyZC5uYW1lLCBsaW5rOiBjYXJkLmxpbmsgfSk7XG4gICAgICAgIGNhcmRMaXN0LmFkZEl0ZW0obmV3Q2FyZCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgICAuZmluYWxseSgoKSA9PiBuZXdDYXJkUG9wdXAuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xuICB9XG4pO1xubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIE9uIGNsaWNrIGV2ZW50IGZvciBhZGRDYXJkIGJ1dHRvblxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBQcm9maWxlIFBpY3R1cmUgSW50ZXJhY3Rpb25cbi8vIFVwZGF0ZSBQcm9maWxlIFBpY3R1cmVcbmNvbnN0IHVwZGF0ZUF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjdXBkYXRlLWF2YXRhci1tb2RhbFwiLCAoaW1hZ2UpID0+IHtcbiAgdXBkYXRlQXZhdGFyUG9wdXAuc2V0U3VibWl0VGV4dCh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKGltYWdlLmltYWdlKVxuICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgICAgdXBkYXRlQXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IHVwZGF0ZUF2YXRhclBvcHVwLnNldFN1Ym1pdFRleHQoZmFsc2UpKTtcbn0pO1xudXBkYXRlQXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gT24gY2xpY2sgZXZlbnQgZm9yIHVwZGF0ZSBwcm9maWxlIHBpY3R1cmVcbnByb2ZpbGVBdmF0YXJFZGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICB1cGRhdGVBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gRXhpc3RpbmcgQ2FyZCBJbnRlcmFjdGlvblxuLy8gWm9vbSBpbiBvbiBjYXJkIGltYWdlXG5jb25zdCBjYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjY2FyZC1tb2RhbFwiKTtcbmNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBEZWxldGUgQ2FyZCBQb3B1cFxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZCkge1xuICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xuICBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0VGV4dCh0cnVlLCBcIkRlbGV0aW5nLi4uXCIpO1xuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgICBjYXJkLmhhbmRsZURlbGV0ZUNhcmQoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKVxuICAgICAgLmZpbmFsbHkoKCkgPT4gZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdFRleHQoZmFsc2UpKTtcbiAgfSk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgdXNlck5hbWUsIHVzZXJBYm91dCwgdXNlckF2YXRhciB9KSB7XG4gICAgdGhpcy5fdXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lKTtcbiAgICB0aGlzLl91c2VyQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBYm91dCk7XG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoaW1hZ2UsIG5hbWUpIHtcbiAgICB0aGlzLl91c2VyQXZhdGFyLnNyYyA9IGltYWdlO1xuICAgIHRoaXMuX3VzZXJBdmF0YXIuYWx0ID0gbmFtZSArIFwiIGF2YXRhclwiO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9hdXRob3JpemF0aW9uID0gaGVhZGVycy5hdXRob3JpemF0aW9uO1xuICAgIHRoaXMuX2NvbnRlbnRUeXBlID0gaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXTtcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgfVxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcImE5M2ViZDJmLWZkMDYtNDk5Zi1iMmY5LTc0ZTJmODUxOTcwOVwiLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIC8vIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgLy8gICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIC8vIH0pO1xuICB9XG5cbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcbiAgZ2V0VXNlcigpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZShkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICB9KSxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXG4gICAgICB9LFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRDYXJkKHRpdGxlLCBsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogdGl0bGUsXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICB9KSxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXG4gICAgICB9LFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcbiAgICAgIH0sXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcbiAgICAgIH0sXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHJlbW92ZUxpa2VDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcbiAgICAgIH0sXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZVByb2ZpbGVQaWN0dXJlKGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICAvLyAudGhlbigocmVzKSA9PiB7XG4gICAgLy8gICBpZiAocmVzLm9rKSB7XG4gICAgLy8gICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIC8vICAgfVxuICAgIC8vICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIC8vIH0pXG4gICAgLy8gLmNhdGNoKChlcnIpID0+IHtcbiAgICAvLyAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgLy8gfSk7XG4gIH1cbn1cblxuKFwiaHR0cHM6Ly93d3cudGhlZmFtb3VzcGVvcGxlLmNvbS9wcm9maWxlcy9pbWFnZXMvamFjcXVlcy1jb3VzdGVhdS0zLmpwZ1wiKTtcblxuKFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9mcm9udGVuZC1kZXZlbG9wZXIvY29tbW9uL2F2YXRhci5qcGdcIik7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fdGl0bGVcIik7XG4gICAgdGhpcy5fcG9wdXBTdWJtaXQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IGRhdGEudXJsO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEudGl0bGU7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IGRhdGEudGl0bGU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cENvbmZpcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9wb3B1cFN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cENvbmZpcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHNldFN1Ym1pdFRleHQoc3VibWl0LCBzdWJtaXRUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChzdWJtaXQpIHtcbiAgICAgIHRoaXMuX3BvcHVwU3VibWl0LnRleHRDb250ZW50ID0gc3VibWl0VGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fcG9wdXBTdWJtaXQudGV4dENvbnRlbnQgPSBcIlllc1wiO1xuICAgIH1cbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBhY3Rpb247XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibmFtZSIsImxpbmsiLCJfaWQiLCJpc0xpa2VkIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0Q2FyZEVsZW1lbnQiLCJfY2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50c0xpc3RlbmVycyIsIl9jYXJkSW1hZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwidXJsIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInJlbW92ZSIsImhhbmRsZUxpa2VJY29uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZ2V0VmlldyIsIl9jYXJkVGl0bGUiLCJzcmMiLCJ0ZXh0Q29udGVudCIsImFsdCIsImFkZCIsIlNlY3Rpb24iLCJzZWxlY3RvciIsImRhdGEiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjbGVhciIsImlubmVySFRNTCIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZSIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfcG9wdXBTdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0U3VibWl0VGV4dCIsInN1Ym1pdCIsInN1Ym1pdFRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybSIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tWYWxpZGl0eSIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlRWRpdEZvcm0iLCJmb3JtcyIsImFkZENhcmRGb3JtIiwicHJvZmlsZUVkaXRCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dERlc2NyaXB0aW9uIiwicHJvZmlsZUFkZEJ1dHRvbiIsInByb2ZpbGVBdmF0YXJFZGl0IiwiYXZhdGFyRm9ybSIsImNhcmRMaXN0IiwibmV3Q2FyZCIsInJlbmRlckNhcmQiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjYXJkUG9wdXAiLCJjYXJkIiwiYXBpIiwicmVtb3ZlTGlrZUNhcmQiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJsaWtlQ2FyZCIsImNhcmRPYmplY3QiLCJ1c2VySW5mbyIsInVzZXJOYW1lIiwidXNlckFib3V0IiwidXNlckF2YXRhciIsIl91c2VyTmFtZSIsIl91c2VyQWJvdXQiLCJfdXNlckF2YXRhciIsImdldFVzZXJJbmZvIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJpbWFnZSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfYXV0aG9yaXphdGlvbiIsImF1dGhvcml6YXRpb24iLCJfY29udGVudFR5cGUiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiZ2V0VXNlciIsInVwZGF0ZVByb2ZpbGUiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJ0aXRsZSIsImRlbGV0ZUNhcmQiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImF2YXRhciIsIlByb21pc2UiLCJhbGwiLCJjYXJkcyIsImFkZEZvcm1WYWxpZGF0b3IiLCJlZGl0UHJvZmlsZVBvcHVwIiwibG9nIiwiZmluYWxseSIsInVzZXJEYXRhIiwibmV3SW5mbyIsIm5ld0NhcmRQb3B1cCIsIl9yZWYyIiwidXBkYXRlQXZhdGFyUG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJfcG9wdXBDb25maXJtIiwiX2hhbmRsZVN1Ym1pdCIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=